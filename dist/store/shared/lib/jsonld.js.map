{"version":3,"sources":["../../../../src/store/shared/lib/jsonld.js"],"names":["getBreadcrumbsForProduct","product","categories","category_id","ids","parentIds","push","index","breadcrumbs","reverse","map","category","find","item","id","categoryId","getBreadcrumbItem","url","name","itemListElement","getBreadcrumbsForCategory","currentCategoryId","position","getProduct","settings","imageUrl","images","length","description","meta_description","image","sku","offers","priceCurrency","currency_code","price","availability","stock_status","getProductJSONLD","jsonldArray","JSON","stringify","getCategoryJSONLD","getJSONLD","window","state","currentPage","type","productDetails","categoryDetails"],"mappings":"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","file":"jsonld.js","sourcesContent":["import { getParentIds } from './helper';\nimport { PAGE, PRODUCT_CATEGORY, PRODUCT, RESERVED } from '../pageTypes';\n\nconst getBreadcrumbsForProduct = (product, categories) => {\n\tif (product && product.category_id) {\n\t\tlet ids = [product.category_id];\n\t\tlet parentIds = getParentIds(categories, product.category_id);\n\t\tids.push(...parentIds);\n\n\t\tlet index = 0;\n\t\tconst breadcrumbs = ids.reverse().map(categoryId => {\n\t\t\tconst category = categories.find(item => item.id === categoryId);\n\t\t\tif (category) {\n\t\t\t\tindex++;\n\t\t\t\treturn getBreadcrumbItem(category.url, category.name, index);\n\t\t\t}\n\t\t});\n\n\t\treturn {\n\t\t\t'@context': 'http://schema.org',\n\t\t\t'@type': 'BreadcrumbList',\n\t\t\titemListElement: breadcrumbs\n\t\t};\n\t} else {\n\t\treturn null;\n\t}\n};\n\nconst getBreadcrumbsForCategory = (currentCategoryId, categories) => {\n\tif (currentCategoryId) {\n\t\tlet ids = getParentIds(categories, currentCategoryId);\n\n\t\tlet index = 0;\n\t\tconst breadcrumbs = ids.reverse().map(categoryId => {\n\t\t\tconst category = categories.find(item => item.id === categoryId);\n\t\t\tif (category) {\n\t\t\t\tindex++;\n\t\t\t\treturn getBreadcrumbItem(category.url, category.name, index);\n\t\t\t}\n\t\t});\n\n\t\treturn {\n\t\t\t'@context': 'http://schema.org',\n\t\t\t'@type': 'BreadcrumbList',\n\t\t\titemListElement: breadcrumbs\n\t\t};\n\t} else {\n\t\treturn null;\n\t}\n};\n\nconst getBreadcrumbItem = (url, name, position) => ({\n\t'@type': 'ListItem',\n\tposition: position,\n\titem: {\n\t\t'@id': url,\n\t\tname: name\n\t}\n});\n\nconst getProduct = (product, settings) => {\n\tlet imageUrl =\n\t\tproduct.images && product.images.length > 0 ? product.images[0].url : null;\n\n\treturn {\n\t\t'@context': 'http://schema.org/',\n\t\t'@type': 'Product',\n\t\tname: product.name,\n\t\tdescription: product.meta_description,\n\t\timage: imageUrl,\n\t\tsku: product.sku,\n\t\toffers: {\n\t\t\t'@type': 'Offer',\n\t\t\tpriceCurrency: settings.currency_code,\n\t\t\tprice: product.price,\n\t\t\tavailability:\n\t\t\t\tproduct.stock_status === 'available'\n\t\t\t\t\t? 'http://schema.org/InStock'\n\t\t\t\t\t: 'http://schema.org/OutOfStock'\n\t\t}\n\t};\n};\n\nconst getProductJSONLD = (product, categories, settings) => {\n\tlet jsonldArray = [];\n\tconst breadcrumbs = getBreadcrumbsForProduct(product, categories);\n\tif (breadcrumbs) {\n\t\tjsonldArray.push(breadcrumbs);\n\t}\n\tjsonldArray.push(getProduct(product, settings));\n\n\treturn jsonldArray.length > 0 ? JSON.stringify(jsonldArray) : '';\n};\n\nconst getCategoryJSONLD = (categoryId, categories) => {\n\tlet jsonldArray = [];\n\tconst breadcrumbs = getBreadcrumbsForCategory(categoryId, categories);\n\tif (breadcrumbs) {\n\t\tjsonldArray.push(breadcrumbs);\n\t}\n\treturn jsonldArray.length > 0 ? JSON.stringify(jsonldArray) : '';\n};\n\nexport const getJSONLD = state => {\n\tif (typeof window === 'undefined') {\n\t\tswitch (state.currentPage.type) {\n\t\t\tcase PRODUCT:\n\t\t\t\treturn getProductJSONLD(\n\t\t\t\t\tstate.productDetails,\n\t\t\t\t\tstate.categories,\n\t\t\t\t\tstate.settings\n\t\t\t\t);\n\t\t\t\tbreak;\n\t\t\tcase PRODUCT_CATEGORY:\n\t\t\t\treturn getCategoryJSONLD(state.categoryDetails.id, state.categories);\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\treturn '';\n\t\t}\n\t} else {\n\t\treturn '';\n\t}\n};\n"]}