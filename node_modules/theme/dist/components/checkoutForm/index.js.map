{"version":3,"sources":["../../../src/components/checkoutForm/index.js"],"names":["CheckoutForm","props","changeStep","setState","step","handleContactsSave","handleContactsEdit","handleShippingSave","handleShippingEdit","handleContactsSubmit","updateCart","email","values","mobile","handleLocationSave","shipping_address","shippingLocation","billing_address","payment_method_id","shipping_method_id","loadShippingMethods","loadPaymentMethods","handleShippingMethodSave","shippingMethodId","handlePaymentMethodSave","paymentMethodId","isShowPaymentForm","payment_method_gateway","state","cart","paymentGatewayExists","handleShippingSubmit","comments","checkout","handleSuccessPayment","handleCheckoutWithToken","payment_token","tokenId","componentDidMount","render","settings","paymentMethods","shippingMethods","loadingShippingMethods","loadingPaymentMethods","checkoutFields","processingCheckout","checkoutInputClass","checkoutButtonClass","checkoutEditButtonClass","items","length","showPaymentForm","shippingMethod","find","method","id","customerDetails","shipping","payment","emptyCheckout","Component"],"mappings":"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","file":"index.js","sourcesContent":["import React from 'react';\nimport { themeSettings, text } from '../../lib/settings';\nimport CheckoutStepContacts from './stepContacts';\nimport CheckoutStepShipping from './stepShipping';\nimport CheckoutStepPayment from './stepPayment';\n\nexport default class CheckoutForm extends React.Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.state = {\n\t\t\tstep: 1\n\t\t};\n\t}\n\n\tcomponentDidMount() {\n\t\tthis.props.loadShippingMethods();\n\t\tthis.props.loadPaymentMethods();\n\t}\n\n\tchangeStep = step => {\n\t\tthis.setState({ step: step });\n\t};\n\n\thandleContactsSave = () => {\n\t\tthis.changeStep(2);\n\t};\n\n\thandleContactsEdit = () => {\n\t\tthis.changeStep(1);\n\t};\n\n\thandleShippingSave = () => {\n\t\tthis.changeStep(3);\n\t};\n\n\thandleShippingEdit = () => {\n\t\tthis.changeStep(2);\n\t};\n\n\thandleContactsSubmit = values => {\n\t\tthis.props.updateCart({\n\t\t\temail: values.email,\n\t\t\tmobile: values.mobile\n\t\t});\n\t\tthis.handleContactsSave();\n\t};\n\n\thandleLocationSave = shippingLocation => {\n\t\tthis.props.updateCart(\n\t\t\t{\n\t\t\t\tshipping_address: shippingLocation,\n\t\t\t\tbilling_address: shippingLocation,\n\t\t\t\tpayment_method_id: null,\n\t\t\t\tshipping_method_id: null\n\t\t\t},\n\t\t\tcart => {\n\t\t\t\tthis.props.loadShippingMethods();\n\t\t\t\tthis.props.loadPaymentMethods();\n\t\t\t}\n\t\t);\n\t};\n\n\thandleShippingMethodSave = shippingMethodId => {\n\t\tthis.props.updateCart(\n\t\t\t{\n\t\t\t\tpayment_method_id: null,\n\t\t\t\tshipping_method_id: shippingMethodId\n\t\t\t},\n\t\t\tcart => {\n\t\t\t\tthis.props.loadPaymentMethods();\n\t\t\t}\n\t\t);\n\t};\n\n\thandlePaymentMethodSave = paymentMethodId => {\n\t\tthis.props.updateCart({\n\t\t\tpayment_method_id: paymentMethodId\n\t\t});\n\t};\n\n\tisShowPaymentForm = () => {\n\t\tconst { payment_method_gateway } = this.props.state.cart;\n\t\tconst paymentGatewayExists =\n\t\t\tpayment_method_gateway && payment_method_gateway !== '';\n\t\treturn paymentGatewayExists;\n\t};\n\n\thandleShippingSubmit = values => {\n\t\tif (this.isShowPaymentForm()) {\n\t\t\tconst { shipping_address, billing_address, comments } = values;\n\n\t\t\tthis.props.updateCart({\n\t\t\t\tshipping_address,\n\t\t\t\tbilling_address,\n\t\t\t\tcomments\n\t\t\t});\n\t\t\tthis.handleShippingSave();\n\t\t} else {\n\t\t\tthis.props.checkout(values);\n\t\t}\n\t};\n\n\thandleSuccessPayment = () => {\n\t\tthis.props.checkout(null);\n\t};\n\n\thandleCheckoutWithToken = tokenId => {\n\t\tthis.props.updateCart(\n\t\t\t{\n\t\t\t\tpayment_token: tokenId\n\t\t\t},\n\t\t\tcart => {\n\t\t\t\tthis.props.checkout(null);\n\t\t\t}\n\t\t);\n\t};\n\n\trender() {\n\t\tconst { step } = this.state;\n\n\t\tconst {\n\t\t\tsettings,\n\t\t\tcart,\n\t\t\tpaymentMethods,\n\t\t\tshippingMethods,\n\t\t\tloadingShippingMethods,\n\t\t\tloadingPaymentMethods,\n\t\t\tcheckoutFields,\n\t\t\tprocessingCheckout\n\t\t} = this.props.state;\n\n\t\tconst {\n\t\t\tcheckoutInputClass = 'checkout-field',\n\t\t\tcheckoutButtonClass = 'checkout-button',\n\t\t\tcheckoutEditButtonClass = 'checkout-button-edit'\n\t\t} = themeSettings;\n\n\t\tif (cart && cart.items.length > 0) {\n\t\t\tconst showPaymentForm = this.isShowPaymentForm();\n\n\t\t\tlet shippingMethod = null;\n\t\t\tconst { shipping_method_id } = cart;\n\t\t\tif (shipping_method_id && shippingMethods && shippingMethods.length > 0) {\n\t\t\t\tshippingMethod = shippingMethods.find(\n\t\t\t\t\tmethod => method.id === shipping_method_id\n\t\t\t\t);\n\t\t\t}\n\n\t\t\treturn (\n\t\t\t\t<div className=\"checkout-form\">\n\t\t\t\t\t<CheckoutStepContacts\n\t\t\t\t\t\tisReadOnly={step > 1}\n\t\t\t\t\t\ttitle={text.customerDetails}\n\t\t\t\t\t\tinputClassName={checkoutInputClass}\n\t\t\t\t\t\tbuttonClassName={checkoutButtonClass}\n\t\t\t\t\t\teditButtonClassName={checkoutEditButtonClass}\n\t\t\t\t\t\tinitialValues={cart}\n\t\t\t\t\t\tsettings={settings}\n\t\t\t\t\t\tpaymentMethods={paymentMethods}\n\t\t\t\t\t\tshippingMethods={shippingMethods}\n\t\t\t\t\t\tloadingShippingMethods={loadingShippingMethods}\n\t\t\t\t\t\tloadingPaymentMethods={loadingPaymentMethods}\n\t\t\t\t\t\tcheckoutFields={checkoutFields}\n\t\t\t\t\t\tonEdit={this.handleContactsEdit}\n\t\t\t\t\t\tonSubmit={this.handleContactsSubmit}\n\t\t\t\t\t\tsaveShippingLocation={this.handleLocationSave}\n\t\t\t\t\t\tsaveShippingMethod={this.handleShippingMethodSave}\n\t\t\t\t\t\tsavePaymentMethod={this.handlePaymentMethodSave}\n\t\t\t\t\t/>\n\n\t\t\t\t\t<CheckoutStepShipping\n\t\t\t\t\t\tshow={step >= 2}\n\t\t\t\t\t\tisReadOnly={step > 2}\n\t\t\t\t\t\ttitle={text.shipping}\n\t\t\t\t\t\tinputClassName={checkoutInputClass}\n\t\t\t\t\t\tbuttonClassName={checkoutButtonClass}\n\t\t\t\t\t\teditButtonClassName={checkoutEditButtonClass}\n\t\t\t\t\t\tinitialValues={cart}\n\t\t\t\t\t\tsettings={settings}\n\t\t\t\t\t\tprocessingCheckout={processingCheckout}\n\t\t\t\t\t\tshippingMethod={shippingMethod}\n\t\t\t\t\t\tcheckoutFields={checkoutFields}\n\t\t\t\t\t\tshowPaymentForm={showPaymentForm}\n\t\t\t\t\t\tonSave={this.handleShippingSave}\n\t\t\t\t\t\tonEdit={this.handleShippingEdit}\n\t\t\t\t\t\tonSubmit={this.handleShippingSubmit}\n\t\t\t\t\t/>\n\n\t\t\t\t\t{showPaymentForm && (\n\t\t\t\t\t\t<CheckoutStepPayment\n\t\t\t\t\t\t\tshow={step === 3}\n\t\t\t\t\t\t\ttitle={text.payment}\n\t\t\t\t\t\t\tinputClassName={checkoutInputClass}\n\t\t\t\t\t\t\tbuttonClassName={checkoutButtonClass}\n\t\t\t\t\t\t\tcart={cart}\n\t\t\t\t\t\t\tsettings={settings}\n\t\t\t\t\t\t\tprocessingCheckout={processingCheckout}\n\t\t\t\t\t\t\thandleSuccessPayment={this.handleSuccessPayment}\n\t\t\t\t\t\t\tonCreateToken={this.handleCheckoutWithToken}\n\t\t\t\t\t\t/>\n\t\t\t\t\t)}\n\t\t\t\t</div>\n\t\t\t);\n\t\t} else {\n\t\t\treturn <p>{text.emptyCheckout}</p>;\n\t\t}\n\t}\n}\n"]}