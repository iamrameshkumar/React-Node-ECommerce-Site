{"version":3,"sources":["../../../src/components/comments/disqus.js"],"names":["DISQUS_CONFIG","__disqusAdded","copyProps","context","props","prefix","Object","keys","forEach","prop","onNewComment","config","callbacks","handleNewComment","comment","Disqus","componentDidMount","loadDisqus","componentDidUpdate","addDisqusScript","child","disqus","document","createElement","parent","getElementsByTagName","async","type","src","shortname","appendChild","url","length","window","location","href","DISQUS","reset","reload","page","replace","render","PureComponent"],"mappings":";;;;;;;;;;;;;;;;AAAA;;;;;;AAEA,IAAMA,gBAAgB,CACrB,WADqB,EAErB,YAFqB,EAGrB,OAHqB,EAIrB,KAJqB,EAKrB,aALqB,EAMrB,cANqB,CAAtB;AAQA,IAAIC,gBAAgB,KAApB;;AAEA,SAASC,SAAT,CAAmBC,OAAnB,EAA4BC,KAA5B,EAAgD;AAAA,KAAbC,MAAa,uEAAJ,EAAI;;AAC/CC,QAAOC,IAAP,CAAYH,KAAZ,EAAmBI,OAAnB,CAA2B,gBAAQ;AAClCL,UAAQE,SAASI,IAAjB,IAAyBL,MAAMK,IAAN,CAAzB;AACA,EAFD;;AAIA,KAAI,OAAOL,MAAMM,YAAb,KAA8B,UAAlC,EAA8C;AAC7CP,UAAQE,SAAS,QAAjB,IAA6B,SAASM,MAAT,GAAkB;AAC9C,QAAKC,SAAL,CAAeF,YAAf,GAA8B,CAC7B,SAASG,gBAAT,CAA0BC,OAA1B,EAAmC;AAClCV,UAAMM,YAAN,CAAmBI,OAAnB;AACA,IAH4B,CAA9B;AAKA,GAND;AAOA;AACD;;IAEoBC,M;;;AACpB,iBAAYX,KAAZ,EAAmB;AAAA;AAAA,wDAClB,gCAAMA,KAAN,CADkB;AAElB;;kBAEDY,iB,gCAAoB;AACnB,OAAKC,UAAL;AACA,E;;kBAEDC,kB,iCAAqB;AACpB,OAAKD,UAAL;AACA,E;;kBAEDE,e,8BAAkB;AACjB,MAAIlB,aAAJ,EAAmB;AAClB;AACA;;AAED,MAAMmB,QAAS,KAAKC,MAAL,GAAcC,SAASC,aAAT,CAAuB,QAAvB,CAA7B;AACA,MAAMC,SACLF,SAASG,oBAAT,CAA8B,MAA9B,EAAsC,CAAtC,KACAH,SAASG,oBAAT,CAA8B,MAA9B,EAAsC,CAAtC,CAFD;;AAIAL,QAAMM,KAAN,GAAc,IAAd;AACAN,QAAMO,IAAN,GAAa,iBAAb;AACAP,QAAMQ,GAAN,GAAY,OAAO,KAAKxB,KAAL,CAAWyB,SAAlB,GAA8B,sBAA1C;;AAEAL,SAAOM,WAAP,CAAmBV,KAAnB;AACAnB,kBAAgB,IAAhB;AACA,E;;kBAEDgB,U,yBAAa;AAAA;;AACZ,MAAMb,QAAQ,EAAd;;AAEA;AACAJ,gBAAcQ,OAAd,CAAsB,gBAAQ;AAC7B,OAAI,CAAC,CAAC,OAAKJ,KAAL,CAAWK,IAAX,CAAN,EAAwB;AACvBL,UAAMK,IAAN,IAAc,OAAKL,KAAL,CAAWK,IAAX,CAAd;AACA;AACD,GAJD;;AAMA;AACA,MAAI,CAACL,MAAM2B,GAAP,IAAc,CAAC3B,MAAM2B,GAAN,CAAUC,MAA7B,EAAqC;AACpC5B,SAAM2B,GAAN,GAAYE,OAAOC,QAAP,CAAgBC,IAA5B;AACA;;AAED;AACA,MAAI,OAAOC,MAAP,KAAkB,WAAtB,EAAmC;AAClCA,UAAOC,KAAP,CAAa;AACZC,YAAQ,IADI;AAEZ3B,YAAQ,SAASA,MAAT,GAAkB;AACzBT,eAAU,KAAKqC,IAAf,EAAqBnC,KAArB;;AAEA;AACA,UAAKmC,IAAL,CAAUR,GAAV,GAAgB,KAAKQ,IAAL,CAAUR,GAAV,CAAcS,OAAd,CAAsB,GAAtB,EAA2B,EAA3B,IAAiC,aAAjD;AACA;AAPW,IAAb;AASA,GAVD,MAUO;AACN;AACAtC,aAAU+B,MAAV,EAAkB7B,KAAlB,EAAyB,SAAzB;AACA,QAAKe,eAAL;AACA;AACD,E;;kBAEDsB,M,qBAAS;AACR,SAAO,uCAAK,IAAG,eAAR,GAAP;AACA,E;;;EAlEkC,gBAAMC,a;;kBAArB3B,M","file":"disqus.js","sourcesContent":["import React from 'react';\n\nconst DISQUS_CONFIG = [\n\t'shortname',\n\t'identifier',\n\t'title',\n\t'url',\n\t'category_id',\n\t'onNewComment'\n];\nlet __disqusAdded = false;\n\nfunction copyProps(context, props, prefix = '') {\n\tObject.keys(props).forEach(prop => {\n\t\tcontext[prefix + prop] = props[prop];\n\t});\n\n\tif (typeof props.onNewComment === 'function') {\n\t\tcontext[prefix + 'config'] = function config() {\n\t\t\tthis.callbacks.onNewComment = [\n\t\t\t\tfunction handleNewComment(comment) {\n\t\t\t\t\tprops.onNewComment(comment);\n\t\t\t\t}\n\t\t\t];\n\t\t};\n\t}\n}\n\nexport default class Disqus extends React.PureComponent {\n\tconstructor(props) {\n\t\tsuper(props);\n\t}\n\n\tcomponentDidMount() {\n\t\tthis.loadDisqus();\n\t}\n\n\tcomponentDidUpdate() {\n\t\tthis.loadDisqus();\n\t}\n\n\taddDisqusScript() {\n\t\tif (__disqusAdded) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst child = (this.disqus = document.createElement('script'));\n\t\tconst parent =\n\t\t\tdocument.getElementsByTagName('head')[0] ||\n\t\t\tdocument.getElementsByTagName('body')[0];\n\n\t\tchild.async = true;\n\t\tchild.type = 'text/javascript';\n\t\tchild.src = '//' + this.props.shortname + '.disqus.com/embed.js';\n\n\t\tparent.appendChild(child);\n\t\t__disqusAdded = true;\n\t}\n\n\tloadDisqus() {\n\t\tconst props = {};\n\n\t\t// Extract Disqus props that were supplied to this component\n\t\tDISQUS_CONFIG.forEach(prop => {\n\t\t\tif (!!this.props[prop]) {\n\t\t\t\tprops[prop] = this.props[prop];\n\t\t\t}\n\t\t});\n\n\t\t// Always set URL\n\t\tif (!props.url || !props.url.length) {\n\t\t\tprops.url = window.location.href;\n\t\t}\n\n\t\t// If Disqus has already been added, reset it\n\t\tif (typeof DISQUS !== 'undefined') {\n\t\t\tDISQUS.reset({\n\t\t\t\treload: true,\n\t\t\t\tconfig: function config() {\n\t\t\t\t\tcopyProps(this.page, props);\n\n\t\t\t\t\t// Disqus needs hashbang URL, see https://help.disqus.com/customer/portal/articles/472107\n\t\t\t\t\tthis.page.url = this.page.url.replace(/#/, '') + '#!newthread';\n\t\t\t\t}\n\t\t\t});\n\t\t} else {\n\t\t\t// Otherwise add Disqus to the page\n\t\t\tcopyProps(window, props, 'disqus_');\n\t\t\tthis.addDisqusScript();\n\t\t}\n\t}\n\n\trender() {\n\t\treturn <div id=\"disqus_thread\" />;\n\t}\n}\n"]}